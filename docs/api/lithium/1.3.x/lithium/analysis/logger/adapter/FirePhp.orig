<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />	<title>lithium\analysis\logger\adapter\FirePhp – Framework API v1.3.x – Documentation – li3 PHP-Framework</title>
		<link rel="stylesheet" href="/assets/v:__PROJECT_VERSION_BUILD__xyzz/css/reset.css" />
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Anonymous+Pro:400,700,400italic,700italic" />
	<link rel="stylesheet" href="/assets/v:__PROJECT_VERSION_BUILD__xyzz/css/u1m.css" />
	<link rel="stylesheet" href="/assets/v:__PROJECT_VERSION_BUILD__xyzz/css/li3_docs.css" />
	<link rel="stylesheet" href="/assets/v:__PROJECT_VERSION_BUILD__xyzz/css/highlight.css" />
	
	
	<script src="//cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
	<script src="/assets/v:__PROJECT_VERSION_BUILD__xyzz/js/base.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/prism/0.0.1/prism.min.js"></script>
	
	
	<link rel="icon" href="/assets/ico/site.png">

		<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-11048416-4', 'auto');
	  ga('send', 'pageview');
	</script>
	</head>
<body class="layout-default li3-docs">
		<div id="container">
			<header class="main">
	<div class="left">
		<h1><a href="/" class="li3-logo">li3</a></h1>
	</div>
	<div class="right">
		<nav class="main-nav"><a href="http://news.li3.me">News</a><a href="/docs" class="active">Documentation</a><a href="/versions">Versions</a><a href="/present">Presentations</a><a href="/support">Community</a><a href="/development">Development</a></nav>	</div>
</header>							<nav class="crumbs">
	<ul itemscope itemtype="http://schema.org/BreadcrumbList">
			<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<meta itemprop="position" content="1" />
							<a href="/docs" itemscope itemprop="item" itemtype="http://schema.org/Thing"><span itemprop="name">Documentation</span></a>
					</li>
			<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<meta itemprop="position" content="2" />
							<a href="/docs/api/lithium/1.3.x/lithium" itemscope itemprop="item" itemtype="http://schema.org/Thing"><span itemprop="name">Framework API (1.3.x)</span></a>
					</li>
			<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<meta itemprop="position" content="3" />
							<a href="/docs/api/lithium/1.3.x/lithium" itemscope itemprop="item" itemtype="http://schema.org/Thing"><span itemprop="name">lithium</span></a>
					</li>
			<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<meta itemprop="position" content="4" />
							<a href="/docs/api/lithium/1.3.x/lithium/analysis" itemscope itemprop="item" itemtype="http://schema.org/Thing"><span itemprop="name">analysis</span></a>
					</li>
			<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<meta itemprop="position" content="5" />
							<a href="/docs/api/lithium/1.3.x/lithium/analysis/logger" itemscope itemprop="item" itemtype="http://schema.org/Thing"><span itemprop="name">logger</span></a>
					</li>
			<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<meta itemprop="position" content="6" />
							<a href="/docs/api/lithium/1.3.x/lithium/analysis/logger/adapter" itemscope itemprop="item" itemtype="http://schema.org/Thing"><span itemprop="name">adapter</span></a>
					</li>
			<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<meta itemprop="position" content="7" />
							<span itemscope itemprop="item" itemtype="http://schema.org/Thing">
					<span itemprop="name">FirePhp</span>
				</span>
					</li>
		</ul>
</nav>						<div id="content">
				<article class="apis-view has-aside-right">

	<nav class="aside aside-right">
			<h3 class="h-gamma">Contents</h3>
		<ul>
			<li class="nav-up"><a href="/docs/api/lithium/1.3.x/lithium/analysis/logger/adapter" rel="up">../</a>		</ul>
	
													
						<h3 class="h-gamma">Methods</h3>
			<ul>
												<li class="method public">
				<a href="/docs/api/lithium/1.3.x/lithium/analysis/logger/adapter/FirePhp::bind()">bind()</a>												<li class="method public">
				<a href="/docs/api/lithium/1.3.x/lithium/analysis/logger/adapter/FirePhp::write()">write()</a>												<li class="method protected">
				<a href="/docs/api/lithium/1.3.x/lithium/analysis/logger/adapter/FirePhp::_write()">_write()</a>												<li class="method protected">
				<a href="/docs/api/lithium/1.3.x/lithium/analysis/logger/adapter/FirePhp::_format()">_format()</a>												<li class="method public inherited">
				<a href="/docs/api/lithium/1.3.x/lithium/core/ObjectDeprecated::__construct()">__construct()</a>												<li class="method protected inherited">
				<a href="/docs/api/lithium/1.3.x/lithium/core/ObjectDeprecated::_init()">_init()</a>												<li class="method public deprecated inherited">
				<a href="/docs/api/lithium/1.3.x/lithium/core/ObjectDeprecated::__set_state()">__set_state()</a>												<li class="method public deprecated inherited">
				<a href="/docs/api/lithium/1.3.x/lithium/core/ObjectDeprecated::respondsTo()">respondsTo()</a>												<li class="method public deprecated inherited">
				<a href="/docs/api/lithium/1.3.x/lithium/core/ObjectDeprecated::invokeMethod()">invokeMethod()</a>												<li class="method protected deprecated inherited">
				<a href="/docs/api/lithium/1.3.x/lithium/core/ObjectDeprecated::_instance()">_instance()</a>												<li class="method protected deprecated inherited">
				<a href="/docs/api/lithium/1.3.x/lithium/core/ObjectDeprecated::_stop()">_stop()</a>												<li class="method protected deprecated inherited">
				<a href="/docs/api/lithium/1.3.x/lithium/core/ObjectDeprecated::_parents()">_parents()</a>												<li class="method public deprecated inherited">
				<a href="/docs/api/lithium/1.3.x/lithium/core/ObjectDeprecated::applyFilter()">applyFilter()</a>												<li class="method protected deprecated inherited">
				<a href="/docs/api/lithium/1.3.x/lithium/core/ObjectDeprecated::_filter()">_filter()</a>							</ul>
								<h3 class="h-gamma">Properties</h3>
			<ul>
												<li class="property protected">
				<a href="/docs/api/lithium/1.3.x/lithium/analysis/logger/adapter/FirePhp::$_headers">$_headers</a>												<li class="property protected">
				<a href="/docs/api/lithium/1.3.x/lithium/analysis/logger/adapter/FirePhp::$_levels">$_levels</a>												<li class="property protected">
				<a href="/docs/api/lithium/1.3.x/lithium/analysis/logger/adapter/FirePhp::$_counter">$_counter</a>												<li class="property protected">
				<a href="/docs/api/lithium/1.3.x/lithium/analysis/logger/adapter/FirePhp::$_response">$_response</a>												<li class="property protected">
				<a href="/docs/api/lithium/1.3.x/lithium/analysis/logger/adapter/FirePhp::$_queue">$_queue</a>												<li class="property protected inherited">
				<a href="/docs/api/lithium/1.3.x/lithium/core/ObjectDeprecated::$_config">$_config</a>												<li class="property protected inherited">
				<a href="/docs/api/lithium/1.3.x/lithium/core/ObjectDeprecated::$_autoConfig">$_autoConfig</a>												<li class="property protected deprecated inherited">
				<a href="/docs/api/lithium/1.3.x/lithium/core/ObjectDeprecated::$_parents">$_parents</a>												<li class="property protected deprecated inherited">
				<a href="/docs/api/lithium/1.3.x/lithium/core/ObjectDeprecated::$_methodFilters">$_methodFilters</a>							</ul>
						</nav>
	<div class="body">
			<h1 class="h-alpha">
		<a href="/docs/api/lithium/1.3.x/lithium" class="symbol-segment">lithium</a>\<a href="/docs/api/lithium/1.3.x/lithium/analysis" class="symbol-segment">analysis</a>\<a href="/docs/api/lithium/1.3.x/lithium/analysis/logger" class="symbol-segment">logger</a>\<a href="/docs/api/lithium/1.3.x/lithium/analysis/logger/adapter" class="symbol-segment">adapter</a>\FirePhp		</h1>

		<section class="under">
													<div class="extends">
					<span class="extends__title">Extends</span>
											<a href="/docs/api/lithium/1.3.x/lithium/core/ObjectDeprecated" class="extends__symbol">lithium\core\ObjectDeprecated</a>									</div>
									<div class="tags">
																<span class="tag">class</span>
			</div>
		</section>

								<section class="deprecated">
															This class, its method, properties and constants are deprecated.
												</section>
			
			<section>
									<div class="summary">
						<p>The <code>FirePhp</code> log adapter allows you to log messages to FirePHP.</p>
					</div>
				
									<div class="description">
						<p>This allows you to inspect native PHP values and objects inside the FireBug console.</p>
<p>Because this adapter interacts directly with the <code>Response</code> object, some additional code is
required to use it. The simplest way to achieve this is to add a filter to the <code>Dispatcher</code>.
For example, the following can be placed in a bootstrap file:</p>
<pre><code class="language-php">use lithium\analysis\Logger;
use lithium\aop\Filters;

Logger::config([
	'default' =&gt; ['adapter' =&gt; 'FirePhp']
]);

Filters::apply('lithium\action\Dispatcher', '_call', function($params, $chain) {
	if (isset($params['callable']-&gt;response)) {
		Logger::adapter('default')-&gt;bind($params['callable']-&gt;response);
	}
	return $next($params);
});
</code></pre>
<p>This will cause the message and other debug settings added to the header of the
response, where FirePHP is able to locate and print it accordingly. As this adapter
implements the protocol specification directly, you don't need another vendor library to
use it.</p>
<p>Now, in you can use the logger in your application code (like controllers, views and models).</p>
<pre><code class="language-php">class PagesController extends \lithium\action\Controller {
	public function view() {
		//...
		Logger::error("Something bad happened!");
		//...
	}
}
</code></pre>
<p>Because this adapter also has a queue implemented, it is possible to log messages even when the
<code>Response</code> object is not yet generated. When it gets generated (and bound), all queued messages
get flushed instantly.</p>
<p>Because FirePHP is not a conventional logging destination like a file or a database, you can
pass everything (except resources) to the logger and inspect it further in FirePHP. In fact,
every message that is passed will be encoded via <code>json_encode()</code>, so check out this built-in
method for more information on how your message will be encoded.</p>
<pre><code class="language-php">Logger::debug(['debug' =&gt; 'me']);
Logger::debug(new \lithium\action\Response());
</code></pre>
					</div>
							</section>

			
			
			
						<section id="related">
				<h3 class="h-beta">Related</h3>
				<ul class="related">
									<li><a href="/docs/api/lithium/1.3.x/lithium/action/Response">lithium\action\Response</a>									<li><a href="/docs/api/lithium/1.3.x/lithium/net/http/Message::headers()">lithium\net\http\Message::headers()</a>								</ul>
			</section>
			
						<section id="links">
				<h3 class="h-beta">Links</h3>
				<ul class="links">
									<li><a href="http://www.firephp.org/" target="new">FirePHP</a>									<li><a href="http://www.firephp.org/Wiki/Reference/Protocol" target="new">FirePHP Protocol Reference</a>									<li><a href="http://php.net/function.json-encode.php" target="new">PHP Manual: `json_encode()`</a>								</ul>
			</section>
			
			
						<section id="source" class="section">
				<h3 class="h-beta">Source</h3>
				<div id="source" class="source-display">
					<div class="source-wrapper">
						<pre class="source-code"><code class="language-php">class FirePhp extends \lithium\core\ObjectDeprecated {

	/**
	 * These headers are specified by FirePHP and get added as headers to the response.
	 *
	 * @var array
	 */
	protected $_headers = [
		&#039;X-Wf-Protocol-1&#039; =&gt; &#039;http://meta.wildfirehq.org/Protocol/JsonStream/0.2&#039;,
		&#039;X-Wf-1-Plugin-1&#039; =&gt; &#039;http://meta.firephp.org/Wildfire/Plugin/FirePHP/Library-FirePHPCore/0.3&#039;,
		&#039;X-Wf-1-Structure-1&#039; =&gt; &#039;http://meta.firephp.org/Wildfire/Structure/FirePHP/FirebugConsole/0.1&#039;
	];

	/**
	 * This is a mapping table that maps Lithium log levels to FirePHP log levels as they
	 * do not correlate directly and FirePHP only accepts a distinct set.
	 *
	 * @var array
	 */
	protected $_levels = [
		&#039;emergency&#039; =&gt; &#039;ERROR&#039;,
		&#039;alert&#039;     =&gt; &#039;ERROR&#039;,
		&#039;critical&#039;  =&gt; &#039;ERROR&#039;,
		&#039;error&#039;     =&gt; &#039;ERROR&#039;,
		&#039;warning&#039;   =&gt; &#039;WARN&#039;,
		&#039;notice&#039;    =&gt; &#039;INFO&#039;,
		&#039;info&#039;      =&gt; &#039;INFO&#039;,
		&#039;debug&#039;     =&gt; &#039;LOG&#039;
	];

	/**
	 * This self-incrementing counter allows the user to log more than one message per request.
	 *
	 * @var integer
	 */
	protected $_counter = 1;

	/**
	 * Holds the response object where the headers will be inserted.
	 */
	protected $_response = null;

	/**
	 * Contains messages that have been written to the log before the bind() call.
	 */
	protected $_queue = [];

	/**
	 * Binds the response object to the logger and sets the required Wildfire
	 * protocol headers.
	 *
	 * @param object $response An instance of a response object (usually `lithium\action\Response`)
	 *               with HTTP request information.
	 * @return void
	 */
	public function bind($response) {
		$this-&gt;_response = $response;
		$this-&gt;_response-&gt;headers += $this-&gt;_headers;

		foreach ($this-&gt;_queue as $message) {
			$this-&gt;_write($message);
		}
	}

	/**
	 * Appends a log message to the response header for FirePHP.
	 *
	 * @param string $priority Represents the message priority.
	 * @param string $message Contains the actual message to store.
	 * @return boolean Always returns `true`. Note that in order for message-writing to take effect,
	 *                 the adapter must be bound to the `Response` object instance associated with
	 *                 the current request. See the `bind()` method.
	 */
	public function write($priority, $message) {
		return function($params) {
			$priority = $params[&#039;priority&#039;];
			$message = $params[&#039;message&#039;];
			$message = $this-&gt;_format($priority, $message);
			$this-&gt;_write($message);
			return true;
		};
	}

	/**
	 * Helper method that writes the message to the header of a bound `Response` object. If no
	 * `Response` object is bound when this method is called, it is stored in a message queue.
	 *
	 * @see lithium\analysis\logger\adapter\FirePhp::_format()
	 * @param array $message A message containing the key and the content to store.
	 * @return array|void The queued message when no `Response` object was bound.
	 */
	protected function _write($message) {
		if (!$this-&gt;_response) {
			return $this-&gt;_queue[] = $message;
		}
		$this-&gt;_response-&gt;headers[$message[&#039;key&#039;]] = $message[&#039;content&#039;];
	}

	/**
	 * Generates a string representation of the type and message, suitable for FirePHP.
	 *
	 * @param string $type Represents the message priority.
	 * @param string $message Contains the actual message to store.
	 * @return array Returns the encoded string representations of the priority and message, in the
	 *               `&#039;key&#039;` and `&#039;content&#039;` keys, respectively.
	 */
	protected function _format($type, $message) {
		$key = &#039;X-Wf-1-1-1-&#039; . $this-&gt;_counter++;

		$content = [[&#039;Type&#039; =&gt; $this-&gt;_levels[$type]], $message];
		$content = json_encode($content);
		$content = strlen($content) . &#039;|&#039; . $content . &#039;|&#039;;

		return compact(&#039;key&#039;, &#039;content&#039;);
	}
}</code></pre>
					</div>
				</div>
			</section>
							</div>
	</article>			</div>
		</div>
		<footer class="main">
	<div class="area"></div>
	<div class="area"></div>
	<div class="area"></div>
	<div class="area"></div>

	<div class="social">
		<a href="https://github.com/unionofrad" target="new">GitHub</a>		<span class="separator">/</span>
		<a href="https://twitter.com/unionofrad" target="new">Twitter</a>		<span class="separator">/</span>
		<a href="http://www.reddit.com/r/li3" target="new">Reddit</a>		<span class="separator">/</span>
		<a href="https://stackoverflow.com/questions/tagged/lithium" target="new">Stack Overflow</a>	</div>
	<div class="testimonial">
		<img src="/assets/v:__PROJECT_VERSION_BUILD__xyzz/img/testimonials/10.png" alt="Testimonial Image" />		<p>I think it's time you started<br />
writing better code.</p>
	</div>
	<div class="copyright">
		Pretty much everything is (c) 2009-2024 and beyond, the <a href="http://unionofrad.org">Union of RAD</a>.	</div>
</footer>	</body>
</body>
</html>
