<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />	<title>LSR 2 Testing – Specifications v1.x – Documentation – li3 PHP-Framework</title>
		<link rel="stylesheet" href="https://li3.me/assets/v:__PROJECT_VERSION_BUILD__xyzz/css/reset.css" />
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Anonymous+Pro:400,700,400italic,700italic" />
	<link rel="stylesheet" href="https://li3.me/assets/v:__PROJECT_VERSION_BUILD__xyzz/css/u1m.css" />
	<link rel="stylesheet" href="https://li3.me/assets/v:__PROJECT_VERSION_BUILD__xyzz/css/li3_docs.css" />
	<link rel="stylesheet" href="https://li3.me/assets/v:__PROJECT_VERSION_BUILD__xyzz/css/highlight.css" />
	
	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
	<script src="https://li3.me/assets/v:__PROJECT_VERSION_BUILD__xyzz/js/base.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/0.0.1/prism.min.js"></script>
	
	
	<link rel="icon" href="https://li3.me/assets/ico/site.png">

		<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-11048416-4', 'auto');
	  ga('send', 'pageview');
	</script>
	</head>
<body class="layout-default li3-docs">
		<div id="container">
			<header class="main">
	<div class="left">
		<h1><a href="https://li3.me/" class="li3-logo">li3</a></h1>
	</div>
	<div class="right">
		<nav class="main-nav"><a href="http://news.li3.me">News</a><a href="https://li3.me/docs" class="active">Documentation</a><a href="https://li3.me/versions">Versions</a><a href="https://li3.me/present">Presentations</a><a href="https://li3.me/support">Community</a><a href="https://li3.me/development">Development</a></nav>	</div>
</header>							<nav class="crumbs">
	<ul itemscope itemtype="http://schema.org/BreadcrumbList">
			<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<meta itemprop="position" content="1" />
							<a href="https://li3.me/docs" itemscope itemprop="item" itemtype="http://schema.org/Thing"><span itemprop="name">Documentation</span></a>
					</li>
			<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<meta itemprop="position" content="2" />
							<a href="https://li3.me/docs/book/specs/1.x" itemscope itemprop="item" itemtype="http://schema.org/Thing"><span itemprop="name">Specifications (1.x)</span></a>
					</li>
			<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<meta itemprop="position" content="3" />
							<a href="https://li3.me/docs/book/specs/1.x/accepted" itemscope itemprop="item" itemtype="http://schema.org/Thing"><span itemprop="name">Accepted</span></a>
					</li>
			<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<meta itemprop="position" content="4" />
							<span itemscope itemprop="item" itemtype="http://schema.org/Thing">
					<span itemprop="name">LSR 2 Testing</span>
				</span>
					</li>
		</ul>
</nav>						<div id="content">
				<article class="books-view has-aside-right">
	<nav class="aside aside-right">
		<h3 class="h-gamma">Contents</h3>
		<ul><li><a href="https://li3.me/docs/book/specs/1.x/draft" class="">Drafts</a><ul><li><a href="https://li3.me/docs/book/specs/1.x/draft/caching" class="">Caching</a><li><a href="https://li3.me/docs/book/specs/1.x/draft/ajax" class="">Ajax</a><li><a href="https://li3.me/docs/book/specs/1.x/draft/logging" class="">Logging</a><li><a href="https://li3.me/docs/book/specs/1.x/draft/formulas" class="">Formulas</a><li><a href="https://li3.me/docs/book/specs/1.x/draft/translating" class="">Translating</a><li><a href="https://li3.me/docs/book/specs/1.x/draft/documentation" class="">Documentation</a><li><a href="https://li3.me/docs/book/specs/1.x/draft/visual-identity" class="">Visual Identity</a><li><a href="https://li3.me/docs/book/specs/1.x/draft/error-handling" class="">Error Handling</a><li><a href="https://li3.me/docs/book/specs/1.x/draft/access" class="">Access</a><li><a href="https://li3.me/docs/book/specs/1.x/draft/globalization" class="">Globalization</a></ul><li><a href="https://li3.me/docs/book/specs/1.x/accepted" class="">Accepted</a><ul><li><a href="LSR-1-documenting.html" class="">LSR 1 Documenting</a><li><a href="LSR-2-testing.html" class="active">LSR 2 Testing</a><li><a href="LSR-0-coding.html" class="">LSR 0 Coding</a></ul></ul>	</nav>
	<div class="body">
		<h1><a id="lsr-2-testing" class="anchor" href="LSR-2-testing.html#lsr-2-testing">LSR-2 Testing</a></h1>
<h2><a id="abstract" class="anchor" href="LSR-2-testing.html#abstract">Abstract</a></h2>
<p>This document is an extension of <a href="LSR-0-coding.html">LSR-0</a>. The goal of this document is to keep core tests consistent. We suggest you follow the same rules in your own projects. For more information see the section on <a href="../../../../manual/quality-code/testing.wiki.html">li3's Unit Testing Framework</a> in the manual.</p>
<h2><a id="class-names" class="anchor" href="LSR-2-testing.html#class-names">Class Names</a></h2>
<p>Class names should be the name of the class you are testing with the <code>Test</code> suffix.</p>
<pre><code class="language-php">class ExampleTest extends \lithium\test\Unit {}
</code></pre>
<h2><a id="mocks" class="anchor" href="LSR-2-testing.html#mocks">Mocks</a></h2>
<p>Often you need to create a mock class to override some functionality of the class you are testing. A mock class will have a prefix of <code>Mock</code> and be located in the a parallel namespace of the class being tested.</p>
<pre><code class="language-php">namespace lithium\tests\mocks\http;

class MockExample extends \lithium\util\Example {}
</code></pre>
<p>In the above example we are going to be using the Mock to test a class in the <code>lithium\http</code> namespace.</p>
<h2><a id="assertions" class="anchor" href="LSR-2-testing.html#assertions">Assertions</a></h2>
<p>Assertions should follow the <code>expected</code> -&gt; <code>result</code> format.</p>
<pre><code class="language-php">$expected = 'works';
$result = Do::somthing();
$this-&gt;assertEqual($expected, $result);
</code></pre>
<p>Always use the right assertion that does the job. The assertion methods are made available through the <code>Unit</code> class from which most tests directly or indirectly inherit. Have a look at the Class Methods section on <a href="../../../../lithium/test/Unit.html">API Browser/Unit</a>.</p>
<pre><code class="language-php">$this-&gt;assertTrue($result);
$this-&gt;assertFalse($result);
$this-&gt;assertNull($result);
// ...
</code></pre>
<h2><a id="isolation" class="anchor" href="LSR-2-testing.html#isolation">Isolation</a></h2>
<p>It is very important that a test runs as part of a sequence of tests without being affected by previous tests or in turn itself affecting tests that run afterwards. All tests need to be correctly isolated. Changes to global state or i.e. configurations must be backed up and than restored after the test run.</p>
<h3><a id="backing-up-and-restoring" class="anchor" href="LSR-2-testing.html#backing-up-and-restoring">Backing up and Restoring</a></h3>
<p>Two methods are relevant for backing up and restoring global state. Within <code>setUp()</code> the current state is by convention backed up into the <code>$_backup</code> property of the test class. In <code>tearDown()</code> the state is restored.</p>
<pre><code class="language-php">class ExampleTest extends \lithium\test\Unit {

    protected $_backup = [];

    public function setUp() {
        $this-&gt;_backup['catalog'] = Catalog::config();
        Catalog::config([
            'runtime' =&gt; ['adapter' =&gt; new Memory()]
        ]);
    }

    public function tearDown() {
        Catalog::reset();
        Catalog::config($this-&gt;_backup['catalog']);
    }
}
</code></pre>
<h2><a id="coverage" class="anchor" href="LSR-2-testing.html#coverage">Coverage</a></h2>
<p>The li3 test coverage policy requires:</p>
<ol>
<li>A corresponding test exists for each class.</li>
<li>All classes have a test coverage of <strong>85%</strong> and higher.</li>
</ol>
<p>These 2 conditions must be met before the project reaches stable.</p>
<p>The current status for li3 regarding test coverage is tracked <a href="https://github.com/UnionOfRAD/lithium/issues/17">through a ticket</a> in our tracking system. Missing tests or coverage are considered a bug.</p>
	</div>
</article>			</div>
		</div>
		<footer class="main">
	<div class="area"></div>
	<div class="area"></div>
	<div class="area"></div>
	<div class="area"></div>

	<div class="social">
		<a href="https://github.com/unionofrad" target="new">GitHub</a>		<span class="separator">/</span>
		<a href="https://twitter.com/unionofrad" target="new">Twitter</a>		<span class="separator">/</span>
		<a href="http://www.reddit.com/r/li3" target="new">Reddit</a>		<span class="separator">/</span>
		<a href="https://stackoverflow.com/questions/tagged/lithium" target="new">Stack Overflow</a>	</div>
	<div class="testimonial">
		<img src="https://li3.me/assets/v:__PROJECT_VERSION_BUILD__xyzz/img/testimonials/10.png" alt="Testimonial Image" />		<p>I think it's time you started<br />
writing better code.</p>
	</div>
	<div class="copyright">
		Pretty much everything is (c) 2009-2024 and beyond, the <a href="http://unionofrad.org">Union of RAD</a>.	</div>
</footer>	</body>
</body>
</html>
