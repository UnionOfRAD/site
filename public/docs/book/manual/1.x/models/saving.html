<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />	<title>Saving – li₃: The Definitive Guide v1.x – Documentation – li3 PHP-Framework</title>
		<link rel="stylesheet" href="../../../../../assets/v:__PROJECT_VERSION_BUILD__xyzz/css/reset.css" />
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Anonymous+Pro:400,700,400italic,700italic" />
	<link rel="stylesheet" href="../../../../../assets/v:__PROJECT_VERSION_BUILD__xyzz/css/u1m.css" />
	<link rel="stylesheet" href="../../../../../assets/v:__PROJECT_VERSION_BUILD__xyzz/css/li3_docs.css" />
	<link rel="stylesheet" href="../../../../../assets/v:__PROJECT_VERSION_BUILD__xyzz/css/highlight.css" />
	
	
	<script src="http://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
	<script src="../../../../../assets/v:__PROJECT_VERSION_BUILD__xyzz/js/base.js"></script>
	<script src="http://cdnjs.cloudflare.com/ajax/libs/prism/0.0.1/prism.min.js"></script>
	
	
	<link rel="icon" href="../../../../../assets/ico/site.png">

		<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-11048416-4', 'auto');
	  ga('send', 'pageview');
	</script>
	</head>
<body class="layout-default li3-docs">
		<div id="container">
			<header class="main">
	<div class="left">
		<h1><a href="../../../../../index.html" class="li3-logo">li3</a></h1>
	</div>
	<div class="right">
		<nav class="main-nav"><a href="http://news.li3.me">News</a><a href="../../../../../docs.html" class="active">Documentation</a><a href="../../../../../versions.html">Versions</a><a href="../../../../../present.html">Presentations</a><a href="../../../../../support.html">Community</a><a href="../../../../../development.html">Development</a></nav>	</div>
</header>							<nav class="crumbs">
	<ul itemscope itemtype="http://schema.org/BreadcrumbList">
			<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<meta itemprop="position" content="1" />
							<a href="../../../../../docs.html" itemscope itemprop="item" itemtype="http://schema.org/Thing"><span itemprop="name">Documentation</span></a>
					</li>
			<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<meta itemprop="position" content="2" />
							<a href="../../1.x.html" itemscope itemprop="item" itemtype="http://schema.org/Thing"><span itemprop="name">li₃: The Definitive Guide (1.x)</span></a>
					</li>
			<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<meta itemprop="position" content="3" />
							<a href="../models.html" itemscope itemprop="item" itemtype="http://schema.org/Thing"><span itemprop="name">Models</span></a>
					</li>
			<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<meta itemprop="position" content="4" />
							<span itemscope itemprop="item" itemtype="http://schema.org/Thing">
					<span itemprop="name">Saving</span>
				</span>
					</li>
		</ul>
</nav>						<div id="content">
				<article class="books-view has-aside-right">
	<nav class="aside aside-right">
		<h3 class="h-gamma">Contents</h3>
		<ul><li><a href="../common-tasks.html" class="">Common Tasks</a><ul><li><a href="../common-tasks/logging.html" class="">Logging</a><li><a href="../common-tasks/plugins.html" class="">Plugins</a><li><a href="../common-tasks/error-handling.html" class="">Error Handling</a><li><a href="../common-tasks/caching.html" class="">Caching</a><li><a href="../common-tasks/filters.html" class="">Filters</a><li><a href="../common-tasks/etags.html" class="">Etags</a><li><a href="../common-tasks/globalization.html" class="">Globalization</a><li><a href="../common-tasks/simple-authentication.html" class="">Simple Authentication</a><li><a href="../common-tasks/simple-auth-user.html" class="">Simple Auth User</a><li><a href="../common-tasks/console-applications.html" class="">Console Applications</a></ul><li><a href="../appendices.html" class="">Appendices</a><ul><li><a href="../appendices/faqs.html" class="">FAQs</a><li><a href="../appendices/using-in-other-applications.html" class="">Using In Other Applications</a></ul><li><a href="../quickstart.html" class="">Quickstart</a><li><a href="../controllers.html" class="">Controllers</a><ul><li><a href="../controllers/actions.html" class="">Actions</a><li><a href="../controllers/flow-control.html" class="">Flow Control</a><li><a href="../controllers/parameters.html" class="">Parameters</a><li><a href="../controllers/type-rendering-detection.html" class="">Type Rendering Detection</a><li><a href="../controllers/routing.html" class="">Routing</a></ul><li><a href="../installation.html" class="">Installation</a><ul><li><a href="../installation/requirements.html" class="">Requirements</a><li><a href="../installation/troubleshooting.html" class="">Troubleshooting</a><li><a href="../installation/web-servers.html" class="">Web Servers</a></ul><li><a href="../architecture.html" class="">Architecture</a><ul><li><a href="../architecture/file-structure.html" class="">File Structure</a><li><a href="../architecture/response-lifecycle.html" class="">Response Lifecycle</a><li><a href="../architecture/aop.html" class="">AOP</a><li><a href="../architecture/mvc.html" class="">MVC</a><li><a href="../architecture/objects.html" class="">Objects</a></ul><li><a href="../quality-code.html" class="">Quality Code</a><ul><li><a href="../quality-code/fixtures.html" class="">Fixtures</a><li><a href="../quality-code/analysis.html" class="">Analysis</a><li><a href="../../../../manual/quality-code/testing.wiki.html" class="">Testing</a><li><a href="../quality-code/security.html" class="">Security</a></ul><li><a href="../configuration.html" class="">Configuration</a><ul><li><a href="../configuration/environment.html" class="">Environment</a><li><a href="../configuration/bootstrapping.html" class="">Bootstrapping</a><li><a href="../configuration/third-party-libraries.html" class="">Third Party Libraries</a></ul><li><a href="../views.html" class="">Views</a><ul><li><a href="../views/layouts.html" class="">Layouts</a><li><a href="../views/elements.html" class="">Elements</a><li><a href="../views/helpers.html" class="">Helpers</a><li><a href="../views/static-content.html" class="">Static Content</a><li><a href="../views/auto-escaping.html" class="">Auto Escaping</a></ul><li><a href="../models.html" class="">Models</a><ul><li><a href="mongodb.html" class="">Mongodb</a><li><a href="meta.html" class="">Meta</a><li><a href="relationships.html" class="">Relationships</a><li><a href="saving.html" class="active">Saving</a><li><a href="using-data-sources.html" class="">Using Data Sources</a><li><a href="adding-functions.html" class="">Adding Functions</a><li><a href="data-mutation.html" class="">Data Mutation</a><li><a href="connections.html" class="">Connections</a><li><a href="creating-data-sources.html" class="">Creating Data Sources</a><li><a href="querying.html" class="">Querying</a><li><a href="validation.html" class="">Validation</a></ul></ul>	</nav>
	<div class="body">
		<h1><a id="saving-entities" class="anchor" href="saving.html#saving-entities">Saving Entities</a></h1>
<p>Persisting data means that new data is being stored or updated. Before you can save your data, you have to initialize a <code>Model</code>. This can either be done with the <code>find()</code> methods shown earlier or—if you want to create a new entity with the static <code>create()</code> method.  <code>save()</code> is a method (called on record and document objects) to create or update the record or document in the database that corresponds to <code>$entity</code>.</p>
<pre><code class="language-php">// Create a new post, add title and author, then save.
$post         = Posts::create();
$post-&gt;title  = 'My first blog post.';
$post-&gt;author = 'Michael';
$post-&gt;save();

// Same as above.
$post = Posts::create([
	'title'  =&gt; 'My first blog post.',
	'author' =&gt; 'Michael'
]);
$post-&gt;save();

// Find the first blog post and change the author
$post = Posts::first();
$post-&gt;author = 'John';
$post-&gt;save();
</code></pre>
<p>Note that <code>save()</code> also validates your data if you have any validation rules defined in your model. It returns either <code>true</code> or <code>false</code>, depending on the success of the validation and saving process. You'll normally use this in your controller like so:</p>
<pre><code class="language-php">public function add() {
	$post = Posts::create();

	if($this-&gt;request-&gt;data &amp;&amp; $post-&gt;save($this-&gt;request-&gt;data)) {
		$this-&gt;redirect('Posts::index');
	}
	return compact('post');
}
</code></pre>
<p>This redirects the user only to the <code>index</code> action if the saving process was successful. If not, the form is rendered again and errors are shown in the view.</p>
<p>To override the validation checks and save anyway, you can pass the <code>'validate'</code> option:</p>
<pre><code class="language-php">$post-&gt;title = "We Don't Need No Stinkin' Validation";
$post-&gt;body = "I know what I'm doing.";
$post-&gt;save(null, ['validate' =&gt; false]);
</code></pre>
<div class="note note-hint">
	There is more information about validation and how to use the
	<code>validates()</code> in the <a href="validation.html">Validation</a> chapter.
</div>
<p>The <code>$entity</code> parameter is the record or document object to be saved in the database. This parameter is implicit and should not be passed under normal circumstances. In the above example, the call to <code>save()</code> on the <code>$post</code> object is transparently proxied through to the <code>Posts</code> model class, and <code>$post</code> is passed in as the <code>$entity</code> parameter.  The <code>$data</code> parameter is for any data that should be assigned to the record before it is saved.</p>
<p>There is also an <code>$options</code> parameter that has the following settable elements.</p>
<ul>
<li><code>'callbacks'</code> <em>boolean</em>: If <code>false</code>, all callbacks will be disabled before executing. Defaults to <code>true</code>.</li>
<li><code>'validate'</code> <em>mixed</em>: If <code>false</code>, validation will be skipped, and the record will be immediately saved. Defaults to <code>true</code>. May also be specified as an array, in which case it will replace the default validation rules specified in the <code>$validates</code> property of the model.</li>
<li><code>'events'</code> <em>mixed</em>: A string or array defining one or more validation <em>events</em>. Events are different contexts in which data events can occur, and correspond to the optional <code>'on'</code> key in validation rules. They will be passed to the validates() method if <code>'validate'</code> is not <code>false</code>.</li>
<li><code>'whitelist'</code> <em>array</em>: An array of fields that are allowed to be saved to this record.</li>
</ul>
	</div>
</article>			</div>
		</div>
		<footer class="main">
	<div class="area"></div>
	<div class="area"></div>
	<div class="area"></div>
	<div class="area"></div>

	<div class="social">
		<a href="https://github.com/unionofrad" target="new">GitHub</a>		<span class="separator">/</span>
		<a href="https://twitter.com/unionofrad" target="new">Twitter</a>		<span class="separator">/</span>
		<a href="http://www.reddit.com/r/li3" target="new">Reddit</a>		<span class="separator">/</span>
		<a href="https://stackoverflow.com/questions/tagged/lithium" target="new">Stack Overflow</a>	</div>
	<div class="testimonial">
		<img src="../../../../../assets/v:__PROJECT_VERSION_BUILD__xyzz/img/testimonials/10.png" alt="Testimonial Image" />		<p>I think it's time you started<br />
writing better code.</p>
	</div>
	<div class="copyright">
		Pretty much everything is (c) 2009-2024 and beyond, the <a href="http://unionofrad.org">Union of RAD</a>.	</div>
</footer>	</body>
</body>
</html>
