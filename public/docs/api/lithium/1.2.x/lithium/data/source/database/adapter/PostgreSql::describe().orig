<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />	<title>lithium\data\source\database\adapter\PostgreSql::describe() – Framework API v1.2.x – Documentation – li3 PHP-Framework</title>
		<link rel="stylesheet" href="/assets/v:__PROJECT_VERSION_BUILD__xyzz/css/reset.css" />
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Anonymous+Pro:400,700,400italic,700italic" />
	<link rel="stylesheet" href="/assets/v:__PROJECT_VERSION_BUILD__xyzz/css/u1m.css" />
	<link rel="stylesheet" href="/assets/v:__PROJECT_VERSION_BUILD__xyzz/css/li3_docs.css" />
	<link rel="stylesheet" href="/assets/v:__PROJECT_VERSION_BUILD__xyzz/css/highlight.css" />
	
	
	<script src="//cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
	<script src="/assets/v:__PROJECT_VERSION_BUILD__xyzz/js/base.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/prism/0.0.1/prism.min.js"></script>
	
	
	<link rel="icon" href="/assets/ico/site.png">

		<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-11048416-4', 'auto');
	  ga('send', 'pageview');
	</script>
	</head>
<body class="layout-default li3-docs">
		<div id="container">
			<header class="main">
	<div class="left">
		<h1><a href="/" class="li3-logo">li3</a></h1>
	</div>
	<div class="right">
		<nav class="main-nav"><a href="http://news.li3.me">News</a><a href="/docs" class="active">Documentation</a><a href="/versions">Versions</a><a href="/present">Presentations</a><a href="/support">Community</a><a href="/development">Development</a></nav>	</div>
</header>							<nav class="crumbs">
	<ul itemscope itemtype="http://schema.org/BreadcrumbList">
			<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<meta itemprop="position" content="1" />
							<a href="/docs" itemscope itemprop="item" itemtype="http://schema.org/Thing"><span itemprop="name">Documentation</span></a>
					</li>
			<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<meta itemprop="position" content="2" />
							<a href="/docs/api/lithium/1.2.x/lithium" itemscope itemprop="item" itemtype="http://schema.org/Thing"><span itemprop="name">Framework API (1.2.x)</span></a>
					</li>
			<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<meta itemprop="position" content="3" />
							<a href="/docs/api/lithium/1.2.x/lithium" itemscope itemprop="item" itemtype="http://schema.org/Thing"><span itemprop="name">lithium</span></a>
					</li>
			<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<meta itemprop="position" content="4" />
							<a href="/docs/api/lithium/1.2.x/lithium/data" itemscope itemprop="item" itemtype="http://schema.org/Thing"><span itemprop="name">data</span></a>
					</li>
			<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<meta itemprop="position" content="5" />
							<a href="/docs/api/lithium/1.2.x/lithium/data/source" itemscope itemprop="item" itemtype="http://schema.org/Thing"><span itemprop="name">source</span></a>
					</li>
			<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<meta itemprop="position" content="6" />
							<a href="/docs/api/lithium/1.2.x/lithium/data/source/database" itemscope itemprop="item" itemtype="http://schema.org/Thing"><span itemprop="name">database</span></a>
					</li>
			<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<meta itemprop="position" content="7" />
							<a href="/docs/api/lithium/1.2.x/lithium/data/source/database/adapter" itemscope itemprop="item" itemtype="http://schema.org/Thing"><span itemprop="name">adapter</span></a>
					</li>
			<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<meta itemprop="position" content="8" />
							<a href="/docs/api/lithium/1.2.x/lithium/data/source/database/adapter/PostgreSql" itemscope itemprop="item" itemtype="http://schema.org/Thing"><span itemprop="name">PostgreSql</span></a>
					</li>
			<li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
			<meta itemprop="position" content="9" />
							<span itemscope itemprop="item" itemtype="http://schema.org/Thing">
					<span itemprop="name">describe()</span>
				</span>
					</li>
		</ul>
</nav>						<div id="content">
				<article class="apis-view has-aside-right">

	<nav class="aside aside-right">
			<h3 class="h-gamma">Contents</h3>
		<ul>
			<li class="nav-up"><a href="/docs/api/lithium/1.2.x/lithium/data/source/database/adapter/PostgreSql" rel="up">../</a>		</ul>
	
													
										</nav>
	<div class="body">
			<h1 class="h-alpha">
		<a href="/docs/api/lithium/1.2.x/lithium" class="symbol-segment">lithium</a>\<a href="/docs/api/lithium/1.2.x/lithium/data" class="symbol-segment">data</a>\<a href="/docs/api/lithium/1.2.x/lithium/data/source" class="symbol-segment">source</a>\<a href="/docs/api/lithium/1.2.x/lithium/data/source/database" class="symbol-segment">database</a>\<a href="/docs/api/lithium/1.2.x/lithium/data/source/database/adapter" class="symbol-segment">adapter</a>\<a href="/docs/api/lithium/1.2.x/lithium/data/source/database/adapter/PostgreSql" class="symbol-segment">PostgreSql</a>::describe()		</h1>

		<section class="under">
																<div class="extends">
					<span class="extends__title">
													Implements
											</span>
					<a href="/docs/api/lithium/1.2.x/lithium/data/Source::describe()" class="extends__symbol">lithium\data\Source::describe()</a>				</div>
						<div class="tags">
													<span class="tag public">public</span>
												<span class="tag">method</span>
			</div>
		</section>

					
			<section>
									<div class="summary">
						<p>Gets the column schema for a given PostgreSQL table.</p>
					</div>
				
							</section>

						<section id="params">
				<h3 class="h-beta">Parameters</h3>
				<ul class="parameters">
											<li>
							<span class="type">mixed</span>
							<code class="name">$entity</code>
															<span class="parameter">
									<p>Specifies the table name for which the schema should be returned, or
the class name of the model object requesting the schema, in which case the model
class will be queried for the correct table name.</p>
								</span>
													</li>
											<li>
							<span class="type">array</span>
							<code class="name">$fields</code>
															<span class="parameter">
									<p>Any schema data pre-defined by the model.</p>
								</span>
													</li>
											<li>
							<span class="type">array</span>
							<code class="name">$meta</code>
													</li>
									</ul>
			</section>
			
						<section id="return">
				<h3 class="h-beta">Returns</h3>
				<span class="type">array</span>
									<span class="return">
						<p>Returns an associative array describing the given table's schema, where the
array keys are the available fields, and the values are arrays describing each
field, containing the following keys:</p>
<ul>
<li><code>'type'</code>: The field type name</li>
</ul>
					</span>
							</section>
			
						<section id="filter" class="flag">
				<h3 class="h-beta">
					Filter
					<nav class="headline-nav">
						<a href="http://li3.me/docs/book/manual/1.x/common-tasks/filters">see how to use filters</a>					</nav>
				</h3>
				<p>
					This method can be filtered.				</p>
			</section>
			
			
			
			
						<section id="source" class="section">
				<h3 class="h-beta">Source</h3>
				<div id="source" class="source-display">
					<div class="source-wrapper">
						<pre class="source-code"><code class="language-php">	public function describe($entity, $fields = [], array $meta = []) {
		$schema = $this-&gt;_config[&#039;schema&#039;];
		$params = compact(&#039;entity&#039;, &#039;meta&#039;, &#039;fields&#039;, &#039;schema&#039;);

		return Filters::run($this, __FUNCTION__, $params, function($params) {
			extract($params);

			if ($fields) {
				return Libraries::instance(null, &#039;schema&#039;, compact(&#039;fields&#039;), $this-&gt;_classes);
			}
			$name = $this-&gt;connection-&gt;quote($this-&gt;_entityName($entity));
			$schema = $this-&gt;connection-&gt;quote($schema);

			$sql  = &#039;SELECT &quot;column_name&quot; AS &quot;field&quot;, &quot;data_type&quot; AS &quot;type&quot;,	&#039;;
			$sql .= &#039;&quot;is_nullable&quot; AS &quot;null&quot;, &quot;column_default&quot; AS &quot;default&quot;, &#039;;
			$sql .= &#039;&quot;character_maximum_length&quot; AS &quot;char_length&quot; &#039;;
			$sql .= &#039;FROM &quot;information_schema&quot;.&quot;columns&quot; WHERE &quot;table_name&quot; = &#039; . $name;
			$sql .= &#039; AND table_schema = &#039; . $schema . &#039; ORDER BY &quot;ordinal_position&quot;&#039;;

			$columns = $this-&gt;connection-&gt;query($sql)-&gt;fetchAll(PDO::FETCH_ASSOC);
			$fields = [];

			foreach ($columns as $column) {
				$schema = $this-&gt;_column($column[&#039;type&#039;]);
				$default = $column[&#039;default&#039;];

				if (preg_match(&quot;/^&#039;(.*)&#039;::/&quot;, $default, $match)) {
					$default = $match[1];
				} elseif ($default === &#039;true&#039;) {
					$default = true;
				} elseif ($default === &#039;false&#039;) {
					$default = false;
				} else {
					$default = null;
				}
				$fields[$column[&#039;field&#039;]] = $schema + [
					&#039;null&#039;     =&gt; ($column[&#039;null&#039;] === &#039;YES&#039; ? true : false),
					&#039;default&#039;  =&gt; $default
				];
				if ($fields[$column[&#039;field&#039;]][&#039;type&#039;] === &#039;string&#039;) {
					$fields[$column[&#039;field&#039;]][&#039;length&#039;] = $column[&#039;char_length&#039;];
				}
			}
			return Libraries::instance(null, &#039;schema&#039;, compact(&#039;fields&#039;), $this-&gt;_classes);
		});
	}</code></pre>
					</div>
				</div>
			</section>
							</div>
	</article>			</div>
		</div>
		<footer class="main">
	<div class="area"></div>
	<div class="area"></div>
	<div class="area"></div>
	<div class="area"></div>

	<div class="social">
		<a href="https://github.com/unionofrad" target="new">GitHub</a>		<span class="separator">/</span>
		<a href="https://twitter.com/unionofrad" target="new">Twitter</a>		<span class="separator">/</span>
		<a href="http://www.reddit.com/r/li3" target="new">Reddit</a>		<span class="separator">/</span>
		<a href="https://stackoverflow.com/questions/tagged/lithium" target="new">Stack Overflow</a>	</div>
	<div class="testimonial">
		<img src="/assets/v:__PROJECT_VERSION_BUILD__xyzz/img/testimonials/10.png" alt="Testimonial Image" />		<p>I think it's time you started<br />
writing better code.</p>
	</div>
	<div class="copyright">
		Pretty much everything is (c) 2009-2024 and beyond, the <a href="http://unionofrad.org">Union of RAD</a>.	</div>
</footer>	</body>
</body>
</html>
